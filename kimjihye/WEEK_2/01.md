
### 테스트의 유용성

테스트란 결국 내가 예상하고 의도했던 대로 코드가 정확히 동작하는지를 확인해서,
만든 코드를 확신할 수 있게 해주는 작업.

> UserDaoTest코드의 테스트방법
> - main() 메서드를 이용해 쉽게 테스트 수행을 가능하게 했다는 점
> - 테스트할 대상인 UserDao를 직접 호출해서 사용한다는 점

### 웹을 통한 DAO 테스트 방법의 문제점
보통 웹 프로그램에서 사용하는 DAO를 테스트하는 방법은 다음과 같다.
```java
DAO를 만든 뒤 바로 테스트하지 않고,
서비스 계층, MVC 프레젠테이션 계층까지 포함한 모든 입출력 기능을 대충이라도 코드로 다 만든다.

이렇게 만들어진 테스트용 웹 애플리케이션을 서버에 배치한 뒤,
웹 화면을 띄워 폼을 열고, 값을 입력한 뒤 버튼을 눌러 등록해본다.

이를 위해서는 폼의 값을 받아서 파싱한 뒤에 User오브젝트로 만들고
UserDao를 호출해주는 기능이 이미 만들어져 있어야한다.

여기까지해서 에러가 없으면
이번엔 검색 폼이나 파라미터를 지정할 수 있는 URL을 사용해서
방금 입력한 데이터를 다시 가져올 수 있는지 테스트해본다.
( 이 역시 UserDao가 돌려주는 결과를 화면에 출력해주는 기능이 만들어져 있어야 확인이 가능함.)
```
=> 가장 흔히 쓰이는 방법이지만, DAO에 대한 테스트로서는 단점이 너무 많음.
- DAO뿐 아니라 서비스 클래스, 컨트롤러, JSP뷰 등 모든 레이어의 기능을 다 만들고 나서야 테스트가 가능함.
- 테스트하는 중에 에러가 나거나 테스트가 실패하면, 어디서 문제가 발생했는지 찾아내야함.
    - 등록이 실패하는 원인은 DB연결방법에 문제가 있어서, DAO코드가 잘못되어 JDBC API를 잘못 호출해서,
      SQL문법이 틀려서, 파라미터로 넘어온 값을 잘못 바인딩해서 등등 매우 많다.
- 정작 테스트할 대상인 DAO의 문제가 아니라 서버 환경에서 웹화면을 통해 DAO를 테스트하려고 만든 다른 코드 때문에 에러가 나거나 테스트가 실패할 수 있음.

## 테스트를 어떻게 만들면 이런 문제를 피하고, 효율적으로 테스트를 활용할 수 있을까?

### 작은 단위의 테스트
테스트는 가능하면 작은 단위로 쪼개서 집중해서 할 수 있어야 함.
**관심사의 분리** 라는 원리가 여기에도 적용된다.

이렇게 작은 단위의 코드에 대해 테스트를 수행하는 것을 **단위 테스트(unit test)** 라고 한다.
> 여기서 단위는 작게보자면 메서드 하나 부터 크게는 사용자 관리 기능을 모두 통틀은 것으로 볼 수도 있다. 충분히 하나의 관심에 집중해서 효율적으로 테스트할만한 범위의 단위

일반적으로 단위는 작을수록 좋다.

```
어떤이는 테스트 중에 DB가 사용되면 단위테스트가 아니라고도 한다.

UserDaoTest는 수행할 때 매번 USER테이블의 내용을 비우고 테스트를 진행했음.
이렇게 사용할 DB의 상태를 테스트가 관장하고 있다면 단위 테슽라고 해도 된다.
다만, DB의 상태가 매번 달라지고, 테스트를 위해 DB를 특정 상태로 만들어줄 수 없다면 그때는 UserDaoTest가 단위테스트로서 가치가 없어진다.

그런 차원에서 통제할 수 없는 외부의 리소스에 의존하는 테스트는 단위 테스트가 아니라고 보기도 하는 것이다.
```

때로는 각종 기능을 모두 사용하는 전과정을 하나로 묶어서 테스트할 필요가 있다.
각 단위 기능은 잘 동작하는데 묶어놓으면 안 되는 경우가 종종 발생하기 때문임.
=> 하지만 이 역시도 이전에 각 단위별로 충분한 검증을 마치고 오류를 잡았으면 오류 찾기가 수월했을 것이다.

단위테스트를 하는 또 한가지 이유
개발자가 설계하고 만든 코드가 원래 의도한 대로 동작하는지를 개발자 스스로 빨리 확인받기 위해서
확인의 대상과 조건이 간단하고 명확할수록 좋음. 그래서 작은 단위로 제한해서 테스트하는 것이 편리함.
단위테스트는 주로 개발자가 만든 코드를 스스로 확인하기 위해 사용하는데,
그래서 이를 개발자 테스트 또는 프로그래머 테스트라고도 함.

개발자가 아닌 전문테스터나 고객이 직접 단위 테스트를 하기도 하는데 그때는 이미 늦음..
이미 단위가 커진 상태인데 그때 오류 고치려고하면 너무 힘들겠지..

### 자동수행 테스트 코드
UserDaoTest의 한 가지 특징은 테스트할 데이터가 코드를 통해 제공되고, 테스트 작업 역시 코드를 통해 자동으로 실행한다는 점.

애플리케이션을 구성하는 클래스 안에 테스트 코드를 포함시키는 것보다는 별도로 테스트용 클래스를 만들어서
테스트 코드를 넣는 편이 낫다.

자동으로 수행되는 테스트의 장점은 자주 반복할 수 있다는 것.

### 지속적인 개선과 점진적인 개발을 위한 테스트
UserDao의 기능을 추가하려고 할 때도 미리 만들어둔 테스트 코드는 유용하게 쓰인다.
일단은 가장 단순한 등록과 조회 기능을 만들고, 이를 테스트로 검증해서 만든 코드에 대한 확신을 갖는다.
거기에 조금씩 기능을 더 추가해가면서 그에 대한 테스트도 함께 추가하는 식으로 점진적인 개발이 가능해짐.
=> 테스트를 이용하면 새로운 기능도 기대한 대로 동작하는지 확인할 수 있을 뿐 아니라, 기존에 만들어뒀던 기능들이 새로운 기능을 추가하느라 수정한 코드에 영향을 받지 않고 여전히 잘 동작하는지를 확인할 수도 있다.

### UserDaoTest의 문제
UserDaoTest는 UI까지 동원되는 번거로운 수동테스트에 비해 장점이 많은건 사실이지만
단점도 있음.

- 수동확인 작업의 번거로움
  입력한 값과 가져온 값이 일치하는지는 사람의 눈으로 확인해야 한다.
  테스트 수행은 코드에 의해 자동으로 진행되지만 테스트 결과를 확인하는 일은 사람의 책임이므로 완전한 자동은 아닌 것이다.
- 실행작업의 번거로움
  DAO가 수백개가 되고 그에 대한 main() 메서드도 그만큼 만들어지면 main() 메서드를 수백번 실행하는 수고가 필요하다. 또한 그 결과를 눈으로 확인해서 기록하고 정리하려면 제법 큰 작업임.
